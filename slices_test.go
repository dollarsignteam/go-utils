package utils

import "testing"

func Test_Map(t *testing.T) {
	s := []int{1, 2, 3, 4, 5}
	double := func(x int) int { return x * 2 }
	r := Map(s, double)
	if len(r) != len(s) {
		t.Errorf("Map: expected %v, got %v", len(s), len(r))
	}
	for i, v := range r {
		if v != s[i]*2 {
			t.Errorf("Map: expected %v, got %v", s[i]*2, v)
		}
	}
}

func Test_Reduce(t *testing.T) {
	s := []int{1, 2, 3, 4, 5}
	f := func(prev int, curr int) int { return prev + curr }
	r := Reduce(s, f, 0)
	if r != 15 {
		t.Errorf("Reduce: expected %v, got %v", 15, r)
	}
}

func Test_Filter(t *testing.T) {
	s := []int{1, 2, 3, 4, 5}
	f := func(x int) bool { return x%2 == 0 }
	r := Filter(s, f)
	if len(r) != 2 {
		t.Errorf("Filter: expected %v, got %v", 2, len(r))
	}
	for _, v := range r {
		if v%2 != 0 {
			t.Errorf("Filter: expected %v, got %v", true, false)
		}
	}
}

func Test_SimpleSort(t *testing.T) {
	s := []int{5, 4, 3, 2, 1}
	r := SimpleSort(s)
	for i, v := range r {
		if v != i+1 {
			t.Errorf("SimpleSort: expected %v, got %v", i+1, v)
		}
	}
}

// Benchmark_SimpleSort on macbook air m1 ram 16GB 	 36754 ops	     ~32420 ns/op
func Benchmark_SimpleSort(b *testing.B) {
	// give me a large slice of unordered elements
	s := []int{
		100, 99, 69, 68, 67, 66, 65, 64, 63, 62,
		61, 60, 59, 58, 57, 56, 55, 54, 53, 52,
		6, 7, 9, 8, 10, 11, 12, 13, 14, 15,
		5, 4, 3, 2, 1, 0, -1, -2, -3, -4,
		1000, 999, 998, 997, 996, 995, 994, 993, 992, 991,
		990, 989, 988, 987, 986, 985, 984, 983, 982, 981,
		980, 979, 978, 977, 976, 975, 974, 973, 972, 971,
		970, 969, 968, 967, 966, 965, 964, 963, 962, 961,
		960, 959, 958, 957, 956, 955, 954, 953, 952, 951,
		950, 949, 948, 947, 946, 945, 944, 943, 942, 941,
		940, 939, 938, 937, 936, 935, 934, 933, 932, 931,
		930, 929, 928, 927, 926, 925, 924, 923, 922, 921,
		920, 919, 918, 917, 916, 915, 914, 913, 912, 911,
		910, 909, 908, 907, 906, 905, 904, 903, 902, 901,
		900, 899, 898, 897, 896, 895, 894, 893, 892, 891,
		890, 889, 888, 887, 886, 885, 884, 883, 882, 881,
		880, 879, 878, 877, 876, 875, 874, 873, 872, 871,
		870, 869, 868, 867, 866, 865, 864, 863, 862, 861,
		860, 859, 858, 857, 856, 855, 854, 853, 852, 851,
		850, 849, 848, 847, 846, 845, 844, 843, 842, 841,
		840, 839, 838, 837, 836, 835, 834, 833, 832, 831,
		830, 829, 828, 827, 826, 825, 824, 823, 822, 821,
		820, 819, 818, 817, 816, 815, 814, 813, 812, 811,
		810, 809, 808, 807, 806, 805, 804, 803, 802, 801,
		800, 799, 798, 797, 796, 795, 794, 793, 792, 791,
		790, 789, 788, 787, 786, 785, 784, 783, 782, 781,
		780, 779, 778, 777, 776, 775, 774, 773, 772, 771,
		770, 769, 768, 767, 766, 765, 764, 763, 762, 761,
		760, 759, 758, 757, 756, 755, 754, 753, 752, 751,
		750, 749, 748, 747, 746, 745, 744, 743, 742, 741,
		740, 739, 738, 737, 736, 735, 734, 733, 732, 731,
		730, 729, 728, 727, 726, 725, 724, 723, 722, 721,
		720, 719, 718, 717, 716, 715, 714, 713, 712, 711,
		710, 709, 708, 707, 706, 705, 704, 703, 702, 701,
		700, 699, 698, 697, 696, 695, 694, 693, 692, 691,
		690, 689, 688, 687, 686, 685, 684, 683, 682, 681,
		680, 679, 678, 677, 676, 675, 674, 673, 672, 671,
		670, 669, 668, 667, 666, 665, 664, 663, 662, 661,
		660, 659, 658, 657, 656, 655, 654, 653, 652, 651,
		650, 649, 648, 647, 646, 645, 644, 643, 642, 641,
		640, 639, 638, 637, 636, 635, 634, 633, 632, 631,
		630, 629, 628, 627, 626, 625, 624, 623, 622, 621,
		620, 619, 618, 617, 616, 615, 614, 613, 612, 611,
		610, 609, 608, 607, 606, 605, 604, 603, 602, 601,
		600, 599, 598, 597, 596, 595, 594, 593, 592, 591,
		590, 589, 588, 587, 586, 585, 584, 583, 582, 581,
		580, 579, 578, 577, 576, 575, 574, 573, 572, 571,
	}
	for i := 0; i < b.N; i++ {
		SimpleSort(s)
	}
}

func Test_SortFunc(t *testing.T) {
	s := []int{5, 4, 3, 2, 1}
	f := func(x int, y int) bool { return x > y }
	r := SortFunc(s, f)
	for i, v := range r {
		if v != i+1 {
			t.Errorf("SortFunc: expected %v, got %v", i+1, v)
		}
	}
}

// Benchmark_SortFunc  on macbook air m1 ram 16GB 	   4956	ops    ~233215  ns/op
func Benchmark_SortFunc(b *testing.B) {
	s := []int{
		100, 99, 69, 68, 67, 66, 65, 64, 63, 62,
		61, 60, 59, 58, 57, 56, 55, 54, 53, 52,
		6, 7, 9, 8, 10, 11, 12, 13, 14, 15,
		5, 4, 3, 2, 1, 0, -1, -2, -3, -4,
		1000, 999, 998, 997, 996, 995, 994, 993, 992, 991,
		990, 989, 988, 987, 986, 985, 984, 983, 982, 981,
		980, 979, 978, 977, 976, 975, 974, 973, 972, 971,
		970, 969, 968, 967, 966, 965, 964, 963, 962, 961,
		960, 959, 958, 957, 956, 955, 954, 953, 952, 951,
		950, 949, 948, 947, 946, 945, 944, 943, 942, 941,
		940, 939, 938, 937, 936, 935, 934, 933, 932, 931,
		930, 929, 928, 927, 926, 925, 924, 923, 922, 921,
		920, 919, 918, 917, 916, 915, 914, 913, 912, 911,
		910, 909, 908, 907, 906, 905, 904, 903, 902, 901,
		900, 899, 898, 897, 896, 895, 894, 893, 892, 891,
		890, 889, 888, 887, 886, 885, 884, 883, 882, 881,
		880, 879, 878, 877, 876, 875, 874, 873, 872, 871,
		870, 869, 868, 867, 866, 865, 864, 863, 862, 861,
		860, 859, 858, 857, 856, 855, 854, 853, 852, 851,
		850, 849, 848, 847, 846, 845, 844, 843, 842, 841,
		840, 839, 838, 837, 836, 835, 834, 833, 832, 831,
		830, 829, 828, 827, 826, 825, 824, 823, 822, 821,
		820, 819, 818, 817, 816, 815, 814, 813, 812, 811,
		810, 809, 808, 807, 806, 805, 804, 803, 802, 801,
		800, 799, 798, 797, 796, 795, 794, 793, 792, 791,
		790, 789, 788, 787, 786, 785, 784, 783, 782, 781,
		780, 779, 778, 777, 776, 775, 774, 773, 772, 771,
		770, 769, 768, 767, 766, 765, 764, 763, 762, 761,
		760, 759, 758, 757, 756, 755, 754, 753, 752, 751,
		750, 749, 748, 747, 746, 745, 744, 743, 742, 741,
		740, 739, 738, 737, 736, 735, 734, 733, 732, 731,
		730, 729, 728, 727, 726, 725, 724, 723, 722, 721,
		720, 719, 718, 717, 716, 715, 714, 713, 712, 711,
		710, 709, 708, 707, 706, 705, 704, 703, 702, 701,
		700, 699, 698, 697, 696, 695, 694, 693, 692, 691,
		690, 689, 688, 687, 686, 685, 684, 683, 682, 681,
		680, 679, 678, 677, 676, 675, 674, 673, 672, 671,
		670, 669, 668, 667, 666, 665, 664, 663, 662, 661,
		660, 659, 658, 657, 656, 655, 654, 653, 652, 651,
		650, 649, 648, 647, 646, 645, 644, 643, 642, 641,
		640, 639, 638, 637, 636, 635, 634, 633, 632, 631,
		630, 629, 628, 627, 626, 625, 624, 623, 622, 621,
		620, 619, 618, 617, 616, 615, 614, 613, 612, 611,
		610, 609, 608, 607, 606, 605, 604, 603, 602, 601,
		600, 599, 598, 597, 596, 595, 594, 593, 592, 591,
		590, 589, 588, 587, 586, 585, 584, 583, 582, 581,
		580, 579, 578, 577, 576, 575, 574, 573, 572, 571,
	}
	f := func(x int, y int) bool { return x > y }
	for i := 0; i < b.N; i++ {
		SortFunc(s, f)
	}
}
